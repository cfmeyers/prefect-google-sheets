
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://stefanocascavilla.github.io/prefect-google-sheets/tasks/">
      
      <link rel="icon" href="../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.10">
    
    
      
        <title>Tasks - prefect-google-sheets</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.975780f9.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.2505c338.min.css">
        
          
          
          <meta name="theme-color" content="#2094f3">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CSource+Code+Pro:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"Source Code Pro"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#prefect_google_sheets.tasks" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="prefect-google-sheets" class="md-header__button md-logo" aria-label="prefect-google-sheets" data-md-component="logo">
      
  <img src="../img/prefect-logo-mark-solid-white-500.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            prefect-google-sheets
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Tasks
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/stefanocascavilla/prefect-google-sheets" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="prefect-google-sheets" class="md-nav__button md-logo" aria-label="prefect-google-sheets" data-md-component="logo">
      
  <img src="../img/prefect-logo-mark-solid-white-500.png" alt="logo">

    </a>
    prefect-google-sheets
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/stefanocascavilla/prefect-google-sheets" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Tasks
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Tasks
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prefect_google_sheets.tasks-classes" class="md-nav__link">
    Classes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect_google_sheets.tasks-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefect_google_sheets.tasks.read_google_sheet_as_data_frame" class="md-nav__link">
    read_google_sheet_as_data_frame()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_google_sheets.tasks.read_google_sheet_as_dict_of_lists" class="md-nav__link">
    read_google_sheet_as_dict_of_lists()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_google_sheets.tasks.read_google_sheet_as_list_of_lists" class="md-nav__link">
    read_google_sheet_as_list_of_lists()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prefect_google_sheets.tasks-classes" class="md-nav__link">
    Classes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect_google_sheets.tasks-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefect_google_sheets.tasks.read_google_sheet_as_data_frame" class="md-nav__link">
    read_google_sheet_as_data_frame()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_google_sheets.tasks.read_google_sheet_as_dict_of_lists" class="md-nav__link">
    read_google_sheet_as_dict_of_lists()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect_google_sheets.tasks.read_google_sheet_as_list_of_lists" class="md-nav__link">
    read_google_sheet_as_list_of_lists()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/stefanocascavilla/prefect-google-sheets/edit/main/docs/tasks.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


<div class="doc doc-object doc-module">



<h1 id="prefect_google_sheets.tasks" class="doc doc-heading">
          <code>prefect_google_sheets.tasks</code>


</h1>

  <div class="doc doc-contents first">
  
      <p>prefect-google-sheets tasks</p>

  

  <div class="doc doc-children">






<h2 id="prefect_google_sheets.tasks-classes">Classes</h2>
<h2 id="prefect_google_sheets.tasks-functions">Functions</h2>

<div class="doc doc-object doc-function">



<h3 id="prefect_google_sheets.tasks.read_google_sheet_as_data_frame" class="doc doc-heading">
<code class="highlight language-python"><span class="n">read_google_sheet_as_data_frame</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>This task leverages the Google Sheets API v4 through the gspread library
in order to read the content of a Google Sheet and return it as a pandas Dataframe.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>is_public_sheet</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether the Google Sheet is public or not.
If True, the google_service_account param will be ignored.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>google_service_account</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="typing.Dict">Dict</span>, str]</code>
          </td>
          <td><p>The Service Account to be used
in order to interact with the Google Sheet.
This can be a dict or a string representing the JSON
Service Account body.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>google_sheet_key</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td><p>The key of the Google Sheet to read data from.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>google_sheet_name</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td><p>The name of the Sheet to read data from.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>first_row_header</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[bool]</code>
          </td>
          <td><p>Whether the first row is the header.
If True, the first row will be used as header and data won't
be read. Otherwise, if set to False. Default set to True</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>on_bad_lines</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td><p>What to do if bad lines are discovered:
'error': An Exception is raised
'warn': A warning is printed and the line  is skipped
'skip': The line is skipped with no warnings
Default set to 'error'</p></td>
          <td>
                <code>&#39;error&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>clean</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[bool]</code>
          </td>
          <td><p>Used in order to remove blank columns and rows left
in the Google Sheet.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td><p>The content of a specific Sheet as a pandas dataframe.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>prefect_google_sheets/tasks.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span>
<span class="k">def</span> <span class="nf">read_google_sheet_as_data_frame</span><span class="p">(</span>
    <span class="n">is_public_sheet</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">google_service_account</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">google_sheet_key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">google_sheet_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">first_row_header</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">on_bad_lines</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
    <span class="n">clean</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This task leverages the Google Sheets API v4 through the gspread library</span>
<span class="sd">    in order to read the content of a Google Sheet and return it as a pandas Dataframe.</span>
<span class="sd">    Args:</span>
<span class="sd">        is_public_sheet: Whether the Google Sheet is public or not.</span>
<span class="sd">            If True, the google_service_account param will be ignored.</span>
<span class="sd">        google_service_account: The Service Account to be used</span>
<span class="sd">            in order to interact with the Google Sheet.</span>
<span class="sd">            This can be a dict or a string representing the JSON</span>
<span class="sd">            Service Account body.</span>
<span class="sd">        google_sheet_key: The key of the Google Sheet to read data from.</span>
<span class="sd">        google_sheet_name: The name of the Sheet to read data from.</span>
<span class="sd">        first_row_header: Whether the first row is the header.</span>
<span class="sd">            If True, the first row will be used as header and data won&#39;t</span>
<span class="sd">            be read. Otherwise, if set to False. Default set to True</span>
<span class="sd">        on_bad_lines: What to do if bad lines are discovered:</span>
<span class="sd">            &#39;error&#39;: An Exception is raised</span>
<span class="sd">            &#39;warn&#39;: A warning is printed and the line  is skipped</span>
<span class="sd">            &#39;skip&#39;: The line is skipped with no warnings</span>
<span class="sd">            Default set to &#39;error&#39;</span>
<span class="sd">        clean: Used in order to remove blank columns and rows left</span>
<span class="sd">            in the Google Sheet.</span>
<span class="sd">    Raises:</span>
<span class="sd">        - `GoogleSheetsConfigurationException`</span>
<span class="sd">            if google_service_account not provided or None</span>
<span class="sd">        - `GoogleSheetsConfigurationException`</span>
<span class="sd">            if google_sheet_key not provided or None</span>
<span class="sd">        - `GoogleSheetsConfigurationException`</span>
<span class="sd">            if google_sheet_name not provided or None</span>
<span class="sd">        - `GoogleSheetServiceAccountError`</span>
<span class="sd">            if the google_service_account is not valid or malformed</span>
<span class="sd">    Returns:</span>
<span class="sd">        The content of a specific Sheet as a pandas dataframe.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_public_sheet</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">google_service_account</span><span class="p">:</span>
        <span class="n">exc_message</span> <span class="o">=</span> <span class="s2">&quot;Missing Google Service Account information.&quot;</span>
        <span class="k">raise</span> <span class="n">GoogleSheetsConfigurationException</span><span class="p">(</span><span class="n">exc_message</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">google_sheet_key</span><span class="p">:</span>
        <span class="n">exc_message</span> <span class="o">=</span> <span class="s2">&quot;Missing the Google Sheet key identifier.&quot;</span>
        <span class="k">raise</span> <span class="n">GoogleSheetsConfigurationException</span><span class="p">(</span><span class="n">exc_message</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">google_sheet_name</span><span class="p">:</span>
        <span class="n">exc_message</span> <span class="o">=</span> <span class="s2">&quot;Missing the Google Sheet name identifier.&quot;</span>
        <span class="k">raise</span> <span class="n">GoogleSheetsConfigurationException</span><span class="p">(</span><span class="n">exc_message</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">is_public_sheet</span><span class="p">:</span>
        <span class="n">sheet</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;https://docs.google.com/spreadsheets/d/</span><span class="si">{</span><span class="n">google_sheet_key</span><span class="si">}</span><span class="s2">/</span>
<span class="s2">            export?format=csv&amp;sheet=</span><span class="si">{</span><span class="n">google_sheet_name</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">google_credentials</span> <span class="o">=</span> <span class="n">generate_google_credentials</span><span class="p">(</span>
            <span class="n">google_service_account</span><span class="o">=</span><span class="n">google_service_account</span>
        <span class="p">)</span>
        <span class="n">gspread_client</span> <span class="o">=</span> <span class="n">gspread</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="n">google_credentials</span><span class="p">)</span>
        <span class="n">sheet</span> <span class="o">=</span> <span class="n">gspread_client</span><span class="o">.</span><span class="n">open_by_key</span><span class="p">(</span><span class="n">google_sheet_key</span><span class="p">)</span><span class="o">.</span><span class="n">worksheet</span><span class="p">(</span>
            <span class="n">google_sheet_name</span>
        <span class="p">)</span>

    <span class="n">sheet_df</span> <span class="o">=</span> <span class="n">get_sheet_dataframe</span><span class="p">(</span>
        <span class="n">sheet</span><span class="p">,</span>
        <span class="n">header</span><span class="o">=</span><span class="mi">0</span> <span class="k">if</span> <span class="n">first_row_header</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">on_bad_lines</span><span class="o">=</span><span class="n">on_bad_lines</span><span class="p">,</span>
        <span class="n">clean</span><span class="o">=</span><span class="n">clean</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">sheet_df</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="prefect_google_sheets.tasks.read_google_sheet_as_dict_of_lists" class="doc doc-heading">
<code class="highlight language-python"><span class="n">read_google_sheet_as_dict_of_lists</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>This task leverages the Google Sheets API v4 through the gspread library
in order to read the content of a Google Sheet and return it as a dict of lists.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>is_public_sheet</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether the Google Sheet is public or not.
If True, the google_service_account param will be ignored.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>google_service_account</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="typing.Dict">Dict</span>, str]</code>
          </td>
          <td><p>The Service Account to be used in order to interact with
the Google Sheet. This can be a dict or a string representing the JSON
Service Account body.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>google_sheet_key</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td><p>The key of the Google Sheet to read data from.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>google_sheet_name</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td><p>The name of the Sheet to read data from.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>first_row_header</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[bool]</code>
          </td>
          <td><p>Whether the first row is the header.
If True, the first row will be used as header and data won't be read.
Otherwise, if set to False. Default set to True</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>on_bad_lines</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td><p>What to do if bad lines are discovered:
'error': An Exception is raised
'warn': A warning is printed and the line  is skipped
'skip': The line is skipped with no warnings
Default set to 'error'</p></td>
          <td>
                <code>&#39;error&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>clean</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[bool]</code>
          </td>
          <td><p>Used in order to remove blank columns and rows left in the Google Sheet.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>]</code>
          </td>
          <td><p>The content of a specific Sheet as a dict of lists.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>prefect_google_sheets/tasks.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span>
<span class="k">def</span> <span class="nf">read_google_sheet_as_dict_of_lists</span><span class="p">(</span>
    <span class="n">is_public_sheet</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">google_service_account</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">google_sheet_key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">google_sheet_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">first_row_header</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">on_bad_lines</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
    <span class="n">clean</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This task leverages the Google Sheets API v4 through the gspread library</span>
<span class="sd">    in order to read the content of a Google Sheet and return it as a dict of lists.</span>
<span class="sd">    Args:</span>
<span class="sd">        is_public_sheet: Whether the Google Sheet is public or not.</span>
<span class="sd">            If True, the google_service_account param will be ignored.</span>
<span class="sd">        google_service_account: The Service Account to be used in order to interact with</span>
<span class="sd">            the Google Sheet. This can be a dict or a string representing the JSON</span>
<span class="sd">            Service Account body.</span>
<span class="sd">        google_sheet_key: The key of the Google Sheet to read data from.</span>
<span class="sd">        google_sheet_name: The name of the Sheet to read data from.</span>
<span class="sd">        first_row_header: Whether the first row is the header.</span>
<span class="sd">            If True, the first row will be used as header and data won&#39;t be read.</span>
<span class="sd">            Otherwise, if set to False. Default set to True</span>
<span class="sd">        on_bad_lines: What to do if bad lines are discovered:</span>
<span class="sd">            &#39;error&#39;: An Exception is raised</span>
<span class="sd">            &#39;warn&#39;: A warning is printed and the line  is skipped</span>
<span class="sd">            &#39;skip&#39;: The line is skipped with no warnings</span>
<span class="sd">            Default set to &#39;error&#39;</span>
<span class="sd">        clean: Used in order to remove blank columns and rows left in the Google Sheet.</span>
<span class="sd">    Raises:</span>
<span class="sd">        - `GoogleSheetsConfigurationException`</span>
<span class="sd">            if google_service_account not provided or None</span>
<span class="sd">        - `GoogleSheetsConfigurationException`</span>
<span class="sd">            if google_sheet_key not provided or None</span>
<span class="sd">        - `GoogleSheetsConfigurationException`</span>
<span class="sd">            if google_sheet_name not provided or None</span>
<span class="sd">        - `GoogleSheetServiceAccountError`</span>
<span class="sd">            if the google_service_account is not valid or malformed</span>
<span class="sd">    Returns:</span>
<span class="sd">        The content of a specific Sheet as a dict of lists.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_public_sheet</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">google_service_account</span><span class="p">:</span>
        <span class="n">exc_message</span> <span class="o">=</span> <span class="s2">&quot;Missing Google Service Account information.&quot;</span>
        <span class="k">raise</span> <span class="n">GoogleSheetsConfigurationException</span><span class="p">(</span><span class="n">exc_message</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">google_sheet_key</span><span class="p">:</span>
        <span class="n">exc_message</span> <span class="o">=</span> <span class="s2">&quot;Missing the Google Sheet key identifier.&quot;</span>
        <span class="k">raise</span> <span class="n">GoogleSheetsConfigurationException</span><span class="p">(</span><span class="n">exc_message</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">google_sheet_name</span><span class="p">:</span>
        <span class="n">exc_message</span> <span class="o">=</span> <span class="s2">&quot;Missing the Google Sheet name identifier.&quot;</span>
        <span class="k">raise</span> <span class="n">GoogleSheetsConfigurationException</span><span class="p">(</span><span class="n">exc_message</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">is_public_sheet</span><span class="p">:</span>
        <span class="n">sheet</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;https://docs.google.com/spreadsheets/d/</span><span class="si">{</span><span class="n">google_sheet_key</span><span class="si">}</span><span class="s2">/</span>
<span class="s2">            export?format=csv&amp;sheet=</span><span class="si">{</span><span class="n">google_sheet_name</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">google_credentials</span> <span class="o">=</span> <span class="n">generate_google_credentials</span><span class="p">(</span>
            <span class="n">google_service_account</span><span class="o">=</span><span class="n">google_service_account</span>
        <span class="p">)</span>
        <span class="n">gspread_client</span> <span class="o">=</span> <span class="n">gspread</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="n">google_credentials</span><span class="p">)</span>
        <span class="n">sheet</span> <span class="o">=</span> <span class="n">gspread_client</span><span class="o">.</span><span class="n">open_by_key</span><span class="p">(</span><span class="n">google_sheet_key</span><span class="p">)</span><span class="o">.</span><span class="n">worksheet</span><span class="p">(</span>
            <span class="n">google_sheet_name</span>
        <span class="p">)</span>

    <span class="n">sheet_df</span> <span class="o">=</span> <span class="n">get_sheet_dataframe</span><span class="p">(</span>
        <span class="n">sheet</span><span class="p">,</span>
        <span class="n">header</span><span class="o">=</span><span class="mi">0</span> <span class="k">if</span> <span class="n">first_row_header</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">on_bad_lines</span><span class="o">=</span><span class="n">on_bad_lines</span><span class="p">,</span>
        <span class="n">clean</span><span class="o">=</span><span class="n">clean</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="n">column_name</span><span class="p">:</span> <span class="n">sheet_df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">column_name</span> <span class="ow">in</span> <span class="n">sheet_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="prefect_google_sheets.tasks.read_google_sheet_as_list_of_lists" class="doc doc-heading">
<code class="highlight language-python"><span class="n">read_google_sheet_as_list_of_lists</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>This task leverages the Google Sheets API v4 through the gspread library
in order to read the content of a Google Sheet and return it as a list of lists.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>is_public_sheet</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether the Google Sheet is public or not.
If True, the google_service_account param will be ignored.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>google_service_account</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="typing.Dict">Dict</span>, str]</code>
          </td>
          <td><p>The Service Account to be used in order to interact with
the Google Sheet. This can be a dict or a string representing the JSON
Service Account body.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>google_sheet_key</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td><p>The key of the Google Sheet to read data from.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>google_sheet_name</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td><p>The name of the Sheet to read data from.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>first_row_header</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[bool]</code>
          </td>
          <td><p>Whether the first row is the header.
If True, the first row will be used as header and data won't be read.
Otherwise, if set to False. Default set to True</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>on_bad_lines</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td><p>What to do if bad lines are discovered:
'error': An Exception is raised
'warn': A warning is printed and the line  is skipped
'skip': The line is skipped with no warnings
Default set to 'error'</p></td>
          <td>
                <code>&#39;error&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>clean</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[bool]</code>
          </td>
          <td><p>Used in order to remove blank columns and rows left in the Google Sheet.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.List">List</span>[<span title="typing.List">List</span>]</code>
          </td>
          <td><p>The content of a specific Sheet as a list of lists.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>prefect_google_sheets/tasks.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span>
<span class="k">def</span> <span class="nf">read_google_sheet_as_list_of_lists</span><span class="p">(</span>
    <span class="n">is_public_sheet</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">google_service_account</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">google_sheet_key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">google_sheet_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">first_row_header</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">on_bad_lines</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
    <span class="n">clean</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This task leverages the Google Sheets API v4 through the gspread library</span>
<span class="sd">    in order to read the content of a Google Sheet and return it as a list of lists.</span>
<span class="sd">    Args:</span>
<span class="sd">        is_public_sheet: Whether the Google Sheet is public or not.</span>
<span class="sd">            If True, the google_service_account param will be ignored.</span>
<span class="sd">        google_service_account: The Service Account to be used in order to interact with</span>
<span class="sd">            the Google Sheet. This can be a dict or a string representing the JSON</span>
<span class="sd">            Service Account body.</span>
<span class="sd">        google_sheet_key: The key of the Google Sheet to read data from.</span>
<span class="sd">        google_sheet_name: The name of the Sheet to read data from.</span>
<span class="sd">        first_row_header: Whether the first row is the header.</span>
<span class="sd">            If True, the first row will be used as header and data won&#39;t be read.</span>
<span class="sd">            Otherwise, if set to False. Default set to True</span>
<span class="sd">        on_bad_lines: What to do if bad lines are discovered:</span>
<span class="sd">            &#39;error&#39;: An Exception is raised</span>
<span class="sd">            &#39;warn&#39;: A warning is printed and the line  is skipped</span>
<span class="sd">            &#39;skip&#39;: The line is skipped with no warnings</span>
<span class="sd">            Default set to &#39;error&#39;</span>
<span class="sd">        clean: Used in order to remove blank columns and rows left in the Google Sheet.</span>
<span class="sd">    Raises:</span>
<span class="sd">        - `GoogleSheetsConfigurationException`</span>
<span class="sd">            if google_service_account not provided or None</span>
<span class="sd">        - `GoogleSheetsConfigurationException`</span>
<span class="sd">            if google_sheet_key not provided or None</span>
<span class="sd">        - `GoogleSheetsConfigurationException`</span>
<span class="sd">            if google_sheet_name not provided or None</span>
<span class="sd">        - `GoogleSheetServiceAccountError`</span>
<span class="sd">            if the google_service_account is not valid or malformed</span>
<span class="sd">    Returns:</span>
<span class="sd">        The content of a specific Sheet as a list of lists.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_public_sheet</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">google_service_account</span><span class="p">:</span>
        <span class="n">exc_message</span> <span class="o">=</span> <span class="s2">&quot;Missing Google Service Account information.&quot;</span>
        <span class="k">raise</span> <span class="n">GoogleSheetsConfigurationException</span><span class="p">(</span><span class="n">exc_message</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">google_sheet_key</span><span class="p">:</span>
        <span class="n">exc_message</span> <span class="o">=</span> <span class="s2">&quot;Missing the Google Sheet key identifier.&quot;</span>
        <span class="k">raise</span> <span class="n">GoogleSheetsConfigurationException</span><span class="p">(</span><span class="n">exc_message</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">google_sheet_name</span><span class="p">:</span>
        <span class="n">exc_message</span> <span class="o">=</span> <span class="s2">&quot;Missing the Google Sheet name identifier.&quot;</span>
        <span class="k">raise</span> <span class="n">GoogleSheetsConfigurationException</span><span class="p">(</span><span class="n">exc_message</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">is_public_sheet</span><span class="p">:</span>
        <span class="n">sheet</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;https://docs.google.com/spreadsheets/d/</span><span class="si">{</span><span class="n">google_sheet_key</span><span class="si">}</span><span class="s2">/</span>
<span class="s2">            export?format=csv&amp;sheet=</span><span class="si">{</span><span class="n">google_sheet_name</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">google_credentials</span> <span class="o">=</span> <span class="n">generate_google_credentials</span><span class="p">(</span>
            <span class="n">google_service_account</span><span class="o">=</span><span class="n">google_service_account</span>
        <span class="p">)</span>
        <span class="n">gspread_client</span> <span class="o">=</span> <span class="n">gspread</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="n">google_credentials</span><span class="p">)</span>
        <span class="n">sheet</span> <span class="o">=</span> <span class="n">gspread_client</span><span class="o">.</span><span class="n">open_by_key</span><span class="p">(</span><span class="n">google_sheet_key</span><span class="p">)</span><span class="o">.</span><span class="n">worksheet</span><span class="p">(</span>
            <span class="n">google_sheet_name</span>
        <span class="p">)</span>

    <span class="n">sheet_df</span> <span class="o">=</span> <span class="n">get_sheet_dataframe</span><span class="p">(</span>
        <span class="n">sheet</span><span class="p">,</span>
        <span class="n">header</span><span class="o">=</span><span class="mi">0</span> <span class="k">if</span> <span class="n">first_row_header</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">on_bad_lines</span><span class="o">=</span><span class="n">on_bad_lines</span><span class="p">,</span>
        <span class="n">clean</span><span class="o">=</span><span class="n">clean</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">sheet_df</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href=".." class="md-footer__link md-footer__link--prev" aria-label="Previous: Home" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Home
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.5a2dcb6a.min.js"></script>
      
    
    
  </body>
</html>